<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Usage • pmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Usage">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wlandau/pmrm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/wlandau/pmrm/blob/main/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="d-none name"><code>usage.Rmd</code></div>
    </div>

    
    
<p>This vignette explains how to use the <code>pmrm</code> package</p>
<div class="section level2">
<h2 id="raw-data">Raw data<a class="anchor" aria-label="anchor" href="#raw-data"></a>
</h2>
<p>The package functions expect tidy longitudinal data with one row per
subject visit and columns with the patient outcome, continuous time,
indicator variables, and optional covariates. The <code>pmrm</code>
package has functions to simulate datasets from each supported
model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wlandau/pmrm" class="external-link">pmrm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmrm_simulate_decline_proportional.html">pmrm_simulate_decline_proportional</a></span><span class="op">(</span></span>
<span>  patients <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  visit_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span>, <span class="fl">1</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The outcome column can have missing values, but no other column must
have missing values.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Baseline outcomes must not be missing.&lt;/p&gt;"><sup>1</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulation</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">12L</span>, <span class="fl">13L</span>, <span class="fl">14L</span>, <span class="fl">15L</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA_real_</span></span></code></pre></div>
<p>The output datasets includes important information that you would
supply to a modeling function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulation</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"t"</span>, <span class="st">"patient"</span>, <span class="st">"visit"</span>, <span class="st">"arm"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,500 × 5</span></span></span>
<span><span class="co">#&gt;         y     t patient   visit   arm  </span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  2.20   0    patient_1 visit_1 arm_1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #BB0000;">NA</span>      1.47 patient_1 visit_2 arm_1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #BB0000;">NA</span>      1.90 patient_1 visit_3 arm_1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1.93   2.73 patient_1 visit_4 arm_1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  3.33   4.04 patient_1 visit_5 arm_1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">4.75</span>   0    patient_2 visit_1 arm_2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  0.271  1.16 patient_2 visit_2 arm_2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  1.95   1.97 patient_2 visit_3 arm_2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  1.99   3.09 patient_2 visit_4 arm_2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  3.60   4.45 patient_2 visit_5 arm_2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,490 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<p>To fit a model, simply supply the preprocessed dataset and optionally
the knot vector <code>xi</code> (which usually just contains the
scheduled times of all the visits). The package is powered by the <a href="https://github.com/kaskr/RTMB" class="external-link"><code>RTMB</code></a> package, so
the model fitting process runs fast.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmrm_model_decline_proportional.html">pmrm_model_decline_proportional</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">simulation</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    time <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>    patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>    visit <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>    arm <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>    covariates <span class="op">=</span> <span class="op">~</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span>,</span>
<span>    visit_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.448   0.013   0.459</span></span></code></pre></div>
<p>The fitted model object has parameter estimates, standard errors,
model constants, the convergence status, raw <a href="https://github.com/kaskr/RTMB" class="external-link"><code>RTMB</code></a> objects, and
other information.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "data"            "constants"       "options"         "objective"      </span></span>
<span><span class="co">#&gt;  [5] "model"           "optimization"    "report"          "initial"        </span></span>
<span><span class="co">#&gt;  [9] "final"           "estimates"       "standard_errors" "metrics"        </span></span>
<span><span class="co">#&gt; [13] "spline"</span></span></code></pre></div>
<p>All estimates:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See also &lt;code&gt;fit$standard_errors&lt;/code&gt;.&lt;/p&gt;"><sup>2</sup></a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 9</span></span>
<span><span class="co">#&gt;  $ alpha : Named num [1:5] 0.0269 0.763 0.9555 1.4059 1.6247</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "1" "2" "3" "4" ...</span></span>
<span><span class="co">#&gt;  $ theta : num [1:2] 0.249 0.375</span></span>
<span><span class="co">#&gt;  $ gamma : num [1:2] -0.954 0.995</span></span>
<span><span class="co">#&gt;  $ phi   : num [1:5] 0.0364 0.0134 -0.0022 -0.0399 0.0403</span></span>
<span><span class="co">#&gt;  $ rho   : num [1:10] -0.0429 -0.0824 0.0437 -0.0715 -0.0532 ...</span></span>
<span><span class="co">#&gt;  $ beta  : num [1:3] 0 0.249 0.375</span></span>
<span><span class="co">#&gt;  $ sigma : num [1:5] 1.037 1.014 0.998 0.961 1.041</span></span>
<span><span class="co">#&gt;  $ Lambda: num [1:5, 1:5] 1 -0.0428 -0.082 0.0436 -0.0712 ...</span></span>
<span><span class="co">#&gt;  $ Sigma : num [1:5, 1:5] 1.0756 -0.045 -0.0849 0.0434 -0.0768 ...</span></span></code></pre></div>
<p>Just the estimates of actual parameters, omitting functions of other
parameters:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Can be supplied to the &lt;code&gt;initial&lt;/code&gt; argument of
&lt;code&gt;&lt;a href="../reference/pmrm_model_decline_proportional.html"&gt;pmrm_model_decline_proportional()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>3</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">final</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ alpha: Named num [1:5] 0.0269 0.763 0.9555 1.4059 1.6247</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "1" "2" "3" "4" ...</span></span>
<span><span class="co">#&gt;  $ theta: num [1:2] 0.249 0.375</span></span>
<span><span class="co">#&gt;  $ gamma: num [1:2] -0.954 0.995</span></span>
<span><span class="co">#&gt;  $ phi  : num [1:5] 0.0364 0.0134 -0.0022 -0.0399 0.0403</span></span>
<span><span class="co">#&gt;  $ rho  : num [1:10] -0.0429 -0.0824 0.0437 -0.0715 -0.0532 ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="checking-and-troubleshooting">Checking and troubleshooting<a class="anchor" aria-label="anchor" href="#checking-and-troubleshooting"></a>
</h2>
<p>Model-checking is an involved topic, and <code>pmrm</code> itself
does not go into tremendous depth. Instead, it offers only the most
basic checks on the fitted model object. The goal is to guide your
intuition and high-level understanding.</p>
<p>First, check the convergence code. A 0 indicates convergence, and a 1
indicates that the model diverged or a local minimum was not otherwise
reached (e.g. in the case of a saddle point).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">optimization</span><span class="op">$</span><span class="va">convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Next, you may wish to check that the parameter estimates and standard
errors make sense.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 9</span></span>
<span><span class="co">#&gt;  $ alpha : Named num [1:5] 0.0269 0.763 0.9555 1.4059 1.6247</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "1" "2" "3" "4" ...</span></span>
<span><span class="co">#&gt;  $ theta : num [1:2] 0.249 0.375</span></span>
<span><span class="co">#&gt;  $ gamma : num [1:2] -0.954 0.995</span></span>
<span><span class="co">#&gt;  $ phi   : num [1:5] 0.0364 0.0134 -0.0022 -0.0399 0.0403</span></span>
<span><span class="co">#&gt;  $ rho   : num [1:10] -0.0429 -0.0824 0.0437 -0.0715 -0.0532 ...</span></span>
<span><span class="co">#&gt;  $ beta  : num [1:3] 0 0.249 0.375</span></span>
<span><span class="co">#&gt;  $ sigma : num [1:5] 1.037 1.014 0.998 0.961 1.041</span></span>
<span><span class="co">#&gt;  $ Lambda: num [1:5, 1:5] 1 -0.0428 -0.082 0.0436 -0.0712 ...</span></span>
<span><span class="co">#&gt;  $ Sigma : num [1:5, 1:5] 1.0756 -0.045 -0.0849 0.0434 -0.0768 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">standard_errors</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 9</span></span>
<span><span class="co">#&gt;  $ alpha : Named num [1:5] 0.0455 0.0637 0.0609 0.063 0.0636</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:5] "1" "2" "3" "4" ...</span></span>
<span><span class="co">#&gt;  $ theta : num [1:2] 0.0412 0.0402</span></span>
<span><span class="co">#&gt;  $ gamma : num [1:2] 0.0206 0.0205</span></span>
<span><span class="co">#&gt;  $ phi   : num [1:5] 0.0316 0.0317 0.0318 0.0318 0.0318</span></span>
<span><span class="co">#&gt;  $ rho   : num [1:10] 0.0449 0.0451 0.0449 0.0451 0.0449 ...</span></span>
<span><span class="co">#&gt;  $ beta  : num [1:3] 0 0.0412 0.0402</span></span>
<span><span class="co">#&gt;  $ sigma : num [1:5] 0.0328 0.0321 0.0318 0.0306 0.0331</span></span>
<span><span class="co">#&gt;  $ Lambda: num [1:5, 1:5] 0 0.0447 0.0446 0.0447 0.0446 ...</span></span>
<span><span class="co">#&gt;  $ Sigma : num [1:5, 1:5] 0.0681 0.0472 0.0466 0.0447 0.0486 ...</span></span></code></pre></div>
<p>Also, please check for odd behavior in the fitted spline
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mi>ξ</mi><mo>,</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x | \xi, \alpha)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knots</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">constants</span><span class="op">$</span><span class="va">spline_knots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">spline</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">knots</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">knots</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" alt="" width="672"></p>
<p>In tough cases, the spline may flatten out at the knot boundaries or
twist in strange directions. If you notice a strange fitted spline in a
divergent model, you may wish to experiment with different knot
placement or hand-pick initial values for the vertical knot distances
<code>alpha</code>. The latter can sometimes help stabilize
<code>theta</code> (especially for <code>pmrm_model_slowing()</code>) by
beginning with an appropriately strict monotone spline. Example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">initial</span></span>
<span><span class="va">initial</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmrm_model_decline_proportional.html">pmrm_model_decline_proportional</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simulation</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  visit <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  arm <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="op">~</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span>,</span>
<span>  visit_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  initial <span class="op">=</span> <span class="va">initial</span> <span class="co"># with hand-picked initial alpha</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can even tweak one or more parameters and then
resume the original optimization.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">final</span> <span class="co"># true parameters from the last fit</span></span>
<span><span class="va">initial</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># reset a scalar parameter that may have diverged</span></span>
<span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmrm_model_decline_proportional.html">pmrm_model_decline_proportional</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">simulation</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  visit <span class="op">=</span> <span class="st">"visit"</span>,</span>
<span>  arm <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="op">~</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span>,</span>
<span>  visit_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  initial <span class="op">=</span> <span class="va">initial</span> <span class="co"># with the modified parameter values</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, you may wish to fit a Bayesian version the model using
<code>tmbstan</code> and check for correlations among the parameters.
Strong pairwise correlations involving the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
parameter may indicate that your spline has too many knots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tmbstan</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a Bayesian version of the same model.</span></span>
<span><span class="co"># Increase the number of chains for the Rhat diagnostic to be valid.</span></span>
<span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu">tmbstan</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">model</span>, chains <span class="op">=</span> <span class="fl">1</span>, refresh <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the MCMC draws.</span></span>
<span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">mcmc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"alpha"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta"</span>, <span class="st">"phi"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot pairwise correlations among MCMC draws.</span></span>
<span><span class="co"># Pairs of parameters should not be strongly correlated.</span></span>
<span><span class="co"># Tight correlations and funneling indicate problems,</span></span>
<span><span class="co"># such as non-identifiability if you have too many knots.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternatively, if you have many parameters, you can look at</span></span>
<span><span class="co"># pairwise linear correlations. However, this may miss</span></span>
<span><span class="co"># important pathologies.</span></span>
<span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">correlations</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summaries">Summaries<a class="anchor" aria-label="anchor" href="#summaries"></a>
</h2>
<p>Use <code><a href="../reference/pmrm_estimates.html">pmrm_estimates()</a></code> to compute estimates, standard
errors, and confidence intervals of model parameters and standard
downstream functions of parameters. For example, here are the active-arm
post-baseline treatment effect parameters:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmrm_estimates.html">pmrm_estimates</a></span><span class="op">(</span><span class="va">fit</span>, parameter <span class="op">=</span> <span class="st">"theta"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   parameter arm   estimate standard_error lower upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> theta     arm_2    0.249         0.041<span style="text-decoration: underline;">2</span> 0.169 0.330</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> theta     arm_3    0.375         0.040<span style="text-decoration: underline;">2</span> 0.296 0.454</span></span></code></pre></div>
<p>And the same for the visit-specific standard deviations of the
residuals:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmrm_estimates.html">pmrm_estimates</a></span><span class="op">(</span><span class="va">fit</span>, parameter <span class="op">=</span> <span class="st">"sigma"</span>, confidence <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#&gt;   parameter visit   estimate standard_error lower upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> sigma     visit_1    1.04          0.032<span style="text-decoration: underline;">8</span> 0.983  1.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sigma     visit_2    1.01          0.032<span style="text-decoration: underline;">1</span> 0.961  1.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sigma     visit_3    0.998         0.031<span style="text-decoration: underline;">8</span> 0.946  1.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> sigma     visit_4    0.961         0.030<span style="text-decoration: underline;">6</span> 0.911  1.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> sigma     visit_5    1.04          0.033<span style="text-decoration: underline;">1</span> 0.987  1.10</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method produces high-level metrics for
model comparison.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;   model  parameterization log_likelihood n_observations n_parameters   aic   bic</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> decli… proportional             -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">556.</span>           <span style="text-decoration: underline;">2</span>494           24 <span style="text-decoration: underline;">7</span>159. <span style="text-decoration: underline;">7</span>299.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="marginals">Marginals<a class="anchor" aria-label="anchor" href="#marginals"></a>
</h2>
<p><code><a href="../reference/pmrm_marginals.html">pmrm_marginals()</a></code> returns estimated marginal means for
each study arm and visit. The continuous time at each visit is given by
the <code>marginals</code> argument to
<code><a href="../reference/pmrm_model_decline_proportional.html">pmrm_model_decline_proportional()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmrm_marginals.html">pmrm_marginals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"outcome"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span></span>
<span><span class="co">#&gt;    arm   visit    time estimate standard_error   lower upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> arm_1 visit_1     0   0.026<span style="text-decoration: underline;">9</span>         0.045<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.116</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> arm_1 visit_2     1   0.763          0.063<span style="text-decoration: underline;">7</span>  0.638  0.888</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> arm_1 visit_3     2   0.955          0.060<span style="text-decoration: underline;">9</span>  0.836  1.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> arm_1 visit_4     3   1.41           0.063<span style="text-decoration: underline;">0</span>  1.28   1.53 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> arm_1 visit_5     4   1.62           0.063<span style="text-decoration: underline;">6</span>  1.50   1.75 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> arm_2 visit_1     0   0.026<span style="text-decoration: underline;">9</span>         0.045<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.116</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> arm_2 visit_2     1   0.579          0.049<span style="text-decoration: underline;">7</span>  0.482  0.677</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> arm_2 visit_3     2   0.724          0.050<span style="text-decoration: underline;">9</span>  0.624  0.824</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> arm_2 visit_4     3   1.06           0.053<span style="text-decoration: underline;">1</span>  0.958  1.17 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> arm_2 visit_5     4   1.23           0.058<span style="text-decoration: underline;">9</span>  1.11   1.34 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> arm_3 visit_1     0   0.026<span style="text-decoration: underline;">9</span>         0.045<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.116</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> arm_3 visit_2     1   0.487          0.043<span style="text-decoration: underline;">2</span>  0.402  0.572</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> arm_3 visit_3     2   0.607          0.045<span style="text-decoration: underline;">3</span>  0.518  0.696</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> arm_3 visit_4     3   0.889          0.051<span style="text-decoration: underline;">1</span>  0.789  0.989</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> arm_3 visit_5     4   1.03           0.056<span style="text-decoration: underline;">9</span>  0.914  1.14</span></span></code></pre></div>
<p>Select <code>type = "change"</code> for estimates of change from
baseline.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmrm_marginals.html">pmrm_marginals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"change"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span></span>
<span><span class="co">#&gt;    arm   visit    time estimate standard_error lower upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> arm_1 visit_1     0    0             0      0     0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> arm_1 visit_2     1    0.736         0.082<span style="text-decoration: underline;">5</span> 0.574 0.898</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> arm_1 visit_3     2    0.929         0.079<span style="text-decoration: underline;">3</span> 0.773 1.08 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> arm_1 visit_4     3    1.38          0.075<span style="text-decoration: underline;">7</span> 1.23  1.53 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> arm_1 visit_5     4    1.60          0.078<span style="text-decoration: underline;">2</span> 1.44  1.75 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> arm_2 visit_1     0    0             0      0     0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> arm_2 visit_2     1    0.553         0.068<span style="text-decoration: underline;">4</span> 0.419 0.687</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> arm_2 visit_3     2    0.697         0.069<span style="text-decoration: underline;">6</span> 0.561 0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> arm_2 visit_4     3    1.04          0.069<span style="text-decoration: underline;">7</span> 0.899 1.17 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> arm_2 visit_5     4    1.20          0.077<span style="text-decoration: underline;">0</span> 1.05  1.35 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> arm_3 visit_1     0    0             0      0     0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> arm_3 visit_2     1    0.460         0.061<span style="text-decoration: underline;">2</span> 0.340 0.580</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> arm_3 visit_3     2    0.580         0.063<span style="text-decoration: underline;">9</span> 0.455 0.706</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> arm_3 visit_4     3    0.862         0.068<span style="text-decoration: underline;">5</span> 0.728 0.996</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> arm_3 visit_5     4    0.999         0.076<span style="text-decoration: underline;">2</span> 0.849 1.15</span></span></code></pre></div>
<p>Select <code>type = "effect"</code> for estimates of the treatment
effect (change from baseline of each active arm minus that of the
control arm).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmrm_marginals.html">pmrm_marginals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"effect"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span></span>
<span><span class="co">#&gt;    arm   visit    time estimate standard_error  lower  upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> arm_1 visit_1     0    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> arm_1 visit_2     1    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> arm_1 visit_3     2    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> arm_1 visit_4     3    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> arm_1 visit_5     4    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> arm_2 visit_1     0    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> arm_2 visit_2     1   -<span style="color: #BB0000;">0.184</span>         0.037<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.256</span> -<span style="color: #BB0000;">0.111</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> arm_2 visit_3     2   -<span style="color: #BB0000;">0.232</span>         0.043<span style="text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.317</span> -<span style="color: #BB0000;">0.146</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> arm_2 visit_4     3   -<span style="color: #BB0000;">0.344</span>         0.064<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000;">0.469</span> -<span style="color: #BB0000;">0.218</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> arm_2 visit_5     4   -<span style="color: #BB0000;">0.398</span>         0.072<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.541</span> -<span style="color: #BB0000;">0.255</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> arm_3 visit_1     0    0             0       0      0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> arm_3 visit_2     1   -<span style="color: #BB0000;">0.276</span>         0.041<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.357</span> -<span style="color: #BB0000;">0.195</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> arm_3 visit_3     2   -<span style="color: #BB0000;">0.348</span>         0.046<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.439</span> -<span style="color: #BB0000;">0.257</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> arm_3 visit_4     3   -<span style="color: #BB0000;">0.517</span>         0.065<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.645</span> -<span style="color: #BB0000;">0.389</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> arm_3 visit_5     4   -<span style="color: #BB0000;">0.599</span>         0.073<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.743</span> -<span style="color: #BB0000;">0.455</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h2>
<p>The package supports a <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method for all PMRMs.
It returns the expected values, standard errors, and confidence
intervals for the outcomes given new data. All the important columns
from the original data need to be part of the new data, except that the
outcome column can be entirely absent.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simulation</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 7</span></span></span>
<span><span class="co">#&gt;   arm   visit    time estimate standard_error  lower  upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> arm_1 visit_1  0       0.939         0.047<span style="text-decoration: underline;">6</span>  0.846  1.03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> arm_1 visit_2  1.47    1.69          0.052<span style="text-decoration: underline;">1</span>  1.59   1.80 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> arm_1 visit_3  1.90   -<span style="color: #BB0000;">1.39</span>          0.069<span style="text-decoration: underline;">7</span> -<span style="color: #BB0000;">1.52</span>  -<span style="color: #BB0000;">1.25</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> arm_1 visit_4  2.73    0.622         0.060<span style="text-decoration: underline;">9</span>  0.503  0.742</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> arm_1 visit_5  4.04    2.92          0.069<span style="text-decoration: underline;">0</span>  2.79   3.06</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h2>
<p><code>pmrm</code> supports an S3 method for the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
generic. This method <code><a href="../reference/plot.pmrm_fit.html">plot.pmrm_fit()</a></code> visually compares the
model to the data. The default plot shows:</p>
<ul>
<li>Raw estimates and confidence intervals on the data, as points and
vertical line segments.</li>
<li>Model-based marginal means and confidence intervals, as horizontal
line segments and boxes around them.</li>
<li>Model-based predictions and confidence bands, as continuous lines
and shaded regions.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  show_predictions <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Defaults to FALSE because predictions take extra time.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" alt="" width="672"></p>
<p>You can customize the plot: for example, to compare the fitted
disease progression trajectory across treatment arms.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  show_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_predictions <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Defaults to FALSE because predictions take extra time.</span></span>
<span>  facet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" alt="" width="672"></p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau, Lars Lau Raket, Kasper Kristensen, Eli Lilly and Company.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
